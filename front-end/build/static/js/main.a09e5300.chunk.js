(this["webpackJsonpfront-end"]=this["webpackJsonpfront-end"]||[]).push([[0],{120:function(e,t,n){},158:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n.n(c),a=n(10),i=n.n(a),s=(n(120),n(13)),o=r.a.createContext(),u=n(189),l=n(30),j=n(202),b=n(201),d=n(203),O=n(186),f=n(95),h={backendUrl:"http://ec2-52-66-160-163.ap-south-1.compute.amazonaws.com"}.backendUrl,v=Object(f.io)(h,{transports:["websocket"],upgrade:!1,autoConnect:!1,path:"/ws"}),m=n(48),x=n(18),p=n(191),g=n(160),I=n(205),y=n(192),D=n(193),S=n(194),C=n(207),w=n(196),k=n(197),E=n(198),F=n(199),U=n(200),W=n(103),N=n.n(W),T=n(101),B=n.n(T),P=n(74),z=n.n(P),A=n(104),J=n.n(A),L=n(5),M=Object(O.a)((function(e){return{root:{display:"flex",alignItems:"center",width:"100%",position:"absolute",bottom:0,height:"10vh",right:0},input:{height:"100%"},friends:{borderRight:"2px solid grey",position:"relative",height:"100vh"}}}));function q(){var e=M(),t=Object(c.useState)([]),n=Object(s.a)(t,2),r=n[0],a=n[1],i=Object(c.useState)([]),l=Object(s.a)(i,2),j=l[0],b=l[1],d=Object(c.useState)(null),O=Object(s.a)(d,2),f=O[0],h=O[1],D=Object(c.useState)(""),S=Object(s.a)(D,2),C=S[0],w=S[1],k=Object(c.useContext)(o)[0];Object(c.useEffect)((function(){v.emit("users",(function(e){var t=e.filter((function(e){return e.userID!==k.userID}));a(t),t.length>0&&h(t[0])}))}),[]),Object(c.useEffect)((function(){null!==f&&v.emit("messages",k.userID,f.userID,(function(e){var t=j.map((function(e){return Object(x.a)(Object(x.a)({},e),{},{active:!1})}));e.forEach((function(e){var n=t.findIndex((function(t){return t.id===e.id}));-1!==n&&t.splice(n,1),t.push(Object(x.a)(Object(x.a)({},e),{},{active:!0}))})),b(t)}))}),[f,h]),Object(c.useEffect)((function(){var e=function(e){var t=r.findIndex((function(t){return t.userID===e.userID}));-1!==t?(r[t].active=!0,a(Object(m.a)(r))):a([].concat(Object(m.a)(r),[e]))},t=function(e){var t=r.map((function(t){return t.userID===e&&(t.active=!1),t}));a(t)},n=function(e){var t=f&&e.from===f.userID;v.emit("message received",e.id,t,(function(e){b([].concat(Object(m.a)(j),[Object(x.a)(Object(x.a)({},e),{},{active:t})]))}))},c=function(e){b(j.map((function(t){if(t.id===e.id){var n=f&&e.to===f.userID;return Object(x.a)(Object(x.a)({},e),{},{active:n})}return t})))};return v.on("user connected",e),v.on("user disconnected",t),v.on("private message",n),v.on("delivered",c),function(){v.off("user connected",e),v.off("user disconnected",t),v.off("private message",n),v.off("delivered",c)}}));var E=function(){var e=f;w(""),v.emit("private message",{from:k.userID,to:e.userID,text:C},(function(e){var t=f&&e.to===f.userID;b([].concat(Object(m.a)(j),[Object(x.a)(Object(x.a)({},e),{},{active:t})]))}))},F=j.filter((function(e){return e.active})).map((function(e,t){return Object(L.jsx)(R,{to:e.to,from:e.from,delivered:e.delivered,seen:e.seen,text:e.text,children:e.text},"message-".concat(t))}));return Object(L.jsxs)(u.a,{container:!0,style:{height:"100vh"},children:[Object(L.jsxs)(u.a,{item:!0,xs:3,className:e.friends,children:[r.map((function(e,t){return Object(L.jsx)(p.a,{component:"nav",children:Object(L.jsx)(H,{username:e.username,userID:e.userID,active:e.active,selectedUser:function(){return h(e)},selected:f&&e.userID===f.userID},e.userID)})})),Object(L.jsx)(K,{})]}),Object(L.jsxs)(u.a,{item:!0,xs:9,style:{position:"relative"},children:[Object(L.jsx)(g.a,{style:{maxHeight:"90vh",overflow:"auto"},children:F}),Object(L.jsx)(g.a,{className:e.root,children:Object(L.jsx)(I.a,{className:e.input,disabled:-1===f,value:C,id:"message",fullWidth:!0,type:"text",onKeyDown:function(e){13===e.which&&E()},placeholder:"Send Message",onChange:function(e){return w(e.target.value)},endAdornment:Object(L.jsx)(y.a,{disabled:-1===f,type:"button","aria-label":"send",onClick:E,children:Object(L.jsx)(B.a,{})})})})]})]})}function H(e){var t=e.username,n=e.active,c=e.selectedUser,r=e.selected;return Object(L.jsxs)(D.a,{button:!0,onClick:c,selected:r,children:[Object(L.jsx)(S.a,{children:Object(L.jsx)(C.a,{title:n?"online":"offline",children:Object(L.jsx)(w.a,{variant:"dot",color:n?"primary":"secondary",overlap:"circular",children:Object(L.jsx)(N.a,{fontSize:"large",color:"primary"})})})}),Object(L.jsx)(k.a,{primary:t})]})}function K(){var e=Object(c.useContext)(o)[0];return Object(L.jsx)(p.a,{component:"nav",style:{position:"absolute",bottom:0,left:0},children:Object(L.jsx)(D.a,{children:Object(L.jsx)(k.a,{primary:"Welcome",secondary:e.username})})})}function R(e){var t=e.text,n=e.from,r=(e.to,e.delivered),a=e.seen,i=Object(c.useContext)(o)[0],s=Object(L.jsx)(J.a,{});return r&&a?s=Object(L.jsx)(z.a,{color:"primary"}):r&&(s=Object(L.jsx)(z.a,{color:"default"})),Object(L.jsxs)(E.a,{style:{position:"relative"},children:[Object(L.jsx)(F.a,{subheader:i.userID===n?"You:":"Friend:"}),Object(L.jsxs)(U.a,{children:[t,n===i.userID&&Object(L.jsx)("div",{style:{position:"absolute",right:10},children:s})]})]})}function Y(){return{top:"50%",left:"50%",transform:"translate(-50%, -50%)"}}var G=Object(O.a)((function(e){return{paper:{position:"absolute",width:400,backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)}}}));var Q=function(){var e=G(),t=Object(c.useState)(Y),n=Object(s.a)(t,1)[0],r=Object(c.useContext)(o),a=Object(s.a)(r,2),i=a[0],O=a[1],f=Object(c.useState)(!0),h=Object(s.a)(f,2),m=h[0],x=h[1],p=Object(c.useState)(!0),g=Object(s.a)(p,2),I=g[0],y=g[1],D=Object(c.useState)(!1),S=Object(s.a)(D,2),C=S[0],w=S[1],k=Object(c.useState)(""),E=Object(s.a)(k,2),F=E[0],U=E[1],W=Object(c.useState)(!0),N=Object(s.a)(W,2),T=N[0],B=N[1];Object(c.useEffect)((function(){var e=localStorage.getItem("userID");return e?(v.auth={userID:e},v.on("session",(function(e,t){y(!1),O(t)})),v.connect()):y(!1),function(){v.disconnect()}}),[]);var P=Object(L.jsxs)(u.a,{container:!0,style:n,className:e.paper,direction:"column",spacing:3,children:[Object(L.jsx)(u.a,{item:!0,children:Object(L.jsx)(l.a,{variant:"h5",gutterBottom:!0,style:{textAlign:"center"},children:"Welcome To Chatter"})}),Object(L.jsx)(u.a,{item:!0,children:Object(L.jsx)(j.a,{error:!C,id:"username",label:"Enter Username",variant:"outlined",helperText:"length greater than 2",fullWidth:!0,required:!0,onChange:function(e){U(e.target.value);var t=e.target.value.length>2;w(t),B(!t)}})}),Object(L.jsx)(u.a,{item:!0,children:Object(L.jsx)(b.a,{variant:"outlined",color:"primary",disabled:T,fullWidth:!0,onClick:function(){x(!1),v.auth={username:F},y(!0),v.on("session",(function(e,t){O(t),y(!1),localStorage.setItem("userID",e)})),v.connect()},children:"Okay"})})]});return I?Object(L.jsx)("div",{}):i?Object(L.jsx)(q,{}):Object(L.jsx)(d.a,{open:m,"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description",children:P})};var V=function(){var e=Object(c.useState)(null),t=Object(s.a)(e,2),n=t[0],r=t[1];return Object(L.jsx)(o.Provider,{value:[n,r],children:Object(L.jsx)(Q,{})})},X=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,208)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),c(e),r(e),a(e),i(e)}))};i.a.render(Object(L.jsx)(r.a.StrictMode,{children:Object(L.jsx)(V,{})}),document.getElementById("root")),X()}},[[158,1,2]]]);
//# sourceMappingURL=main.a09e5300.chunk.js.map