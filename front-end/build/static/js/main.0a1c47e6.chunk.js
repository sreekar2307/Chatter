(this["webpackJsonpfront-end"]=this["webpackJsonpfront-end"]||[]).push([[0],{119:function(e,t,n){},157:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(10),s=n.n(a),i=(n(119),n(13)),o=c.a.createContext(),u=n(188),l=n(29),j=n(201),d=n(200),b=n(202),O=n(185),f=n(94),h={backendUrl:"http://ec2-52-66-160-163.ap-south-1.compute.amazonaws.com"}.backendUrl,m=Object(f.io)(h,{transports:["websocket"],upgrade:!1,autoConnect:!1,path:"/ws"}),x=n(47),p=n(190),v=n(159),g=n(204),I=n(191),y=n(192),D=n(193),S=n(206),C=n(195),k=n(196),w=n(197),F=n(198),U=n(199),W=n(102),E=n.n(W),N=n(100),T=n.n(N),B=n(73),P=n.n(B),z=n(103),A=n.n(z),J=n(5),L=Object(O.a)((function(e){return{root:{display:"flex",alignItems:"center",width:"100%",position:"absolute",bottom:0,height:"10vh",right:0},input:{height:"100%"},friends:{borderRight:"2px solid grey",position:"relative",height:"100vh"}}}));function M(){var e=L(),t=Object(r.useState)([]),n=Object(i.a)(t,2),c=n[0],a=n[1],s=Object(r.useState)([]),l=Object(i.a)(s,2),j=l[0],d=l[1],b=Object(r.useState)(-1),O=Object(i.a)(b,2),f=O[0],h=O[1],y=Object(r.useState)(""),D=Object(i.a)(y,2),S=D[0],C=D[1],k=Object(r.useContext)(o)[0];Object(r.useEffect)((function(){m.emit("users",(function(e){a(e.filter((function(e){return e.userID!==k.userID})))}));var e=function(e){var t=c.findIndex((function(t){return t.userID===e.userID}));-1!==t?(c[t].active=!0,a(Object(x.a)(c))):a([].concat(Object(x.a)(c),[e]))},t=function(e){var t=c.map((function(t){return t.userID===e&&(t.active=!1),t}));a(t)},n=function(e){var t=e.to===k.userID;m.emit("message received",e.id,t,(function(e){var t=[].concat(Object(x.a)(j),[e]);d(t)}))},r=function(e){var t=j.map((function(t){return t.id===e.id?e:t}));d(t)};return m.on("user connected",e),m.on("user disconnected",t),m.on("private message",n),m.on("delivered",r),function(){m.off("user connected",e),m.off("user disconnected",t),m.off("private message",n),m.off("delivered",r)}}));var w=function(e){h(c.findIndex((function(t){return t.userID===e}))),m.emit("messages",k.userID,e,(function(e){d(Object.values(e))}))},F=function(){var e=c[f];C(""),m.emit("private message",{from:k.userID,to:e.userID,text:S},(function(e){d([].concat(Object(x.a)(j),[e]))}))},U=j.map((function(e,t){return Object(J.jsx)(K,{to:e.to,from:e.from,delivered:e.delivered,seen:e.seen,text:e.text,style:-1!==f&&(e.to===c[f].userID&&e.from===k.userID||e.from===c[f].userID&&e.to===k.userID)?{display:"block"}:{display:"none"},children:e.text},"message-".concat(t))}));return Object(J.jsxs)(u.a,{container:!0,style:{height:"100vh"},children:[Object(J.jsxs)(u.a,{item:!0,xs:3,className:e.friends,children:[c.map((function(e,t){return Object(J.jsx)(p.a,{component:"nav",children:Object(J.jsx)(q,{username:e.username,userID:e.userID,active:e.active,selectedUser:w,selected:t===f},e.userID)})})),Object(J.jsx)(H,{})]}),Object(J.jsxs)(u.a,{item:!0,xs:9,style:{position:"relative"},children:[Object(J.jsx)(v.a,{style:{maxHeight:"90vh",overflow:"auto"},children:U}),Object(J.jsx)(v.a,{className:e.root,children:Object(J.jsx)(g.a,{className:e.input,disabled:-1===f,value:S,id:"message",fullWidth:!0,type:"text",onKeyDown:function(e){13===e.which&&F()},placeholder:"Send Message",onChange:function(e){return C(e.target.value)},endAdornment:Object(J.jsx)(I.a,{disabled:-1===f,type:"button","aria-label":"send",onClick:F,children:Object(J.jsx)(T.a,{})})})})]})]})}function q(e){var t=e.userID,n=e.username,r=e.active,c=e.selectedUser,a=e.selected;return Object(J.jsxs)(y.a,{button:!0,onClick:function(){return c(t)},selected:a,children:[Object(J.jsx)(D.a,{children:Object(J.jsx)(S.a,{title:r?"online":"offline",children:Object(J.jsx)(C.a,{variant:"dot",color:r?"primary":"secondary",overlap:"circular",children:Object(J.jsx)(E.a,{fontSize:"large",color:"primary"})})})}),Object(J.jsx)(k.a,{primary:n})]})}function H(){var e=Object(r.useContext)(o)[0];return Object(J.jsx)(p.a,{component:"nav",style:{position:"absolute",bottom:0,left:0},children:Object(J.jsx)(y.a,{children:Object(J.jsx)(k.a,{primary:"Welcome",secondary:e.username})})})}function K(e){var t=e.text,n=e.from,c=(e.to,e.delivered),a=e.seen,s=Object(r.useContext)(o)[0],i=Object(J.jsx)(A.a,{});return c&&a?i=Object(J.jsx)(P.a,{color:"primary"}):c&&(i=Object(J.jsx)(P.a,{color:"inherit"})),Object(J.jsxs)(w.a,{style:{position:"relative"},children:[Object(J.jsx)(F.a,{subheader:s.userID===n?"You:":"Friend:"}),Object(J.jsxs)(U.a,{children:[t,Object(J.jsx)("div",{style:{position:"absolute",right:10},children:i})]})]})}function R(){return{top:"50%",left:"50%",transform:"translate(-50%, -50%)"}}var Y=Object(O.a)((function(e){return{paper:{position:"absolute",width:400,backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)}}}));var G=function(){var e=Y(),t=Object(r.useState)(R),n=Object(i.a)(t,1)[0],c=Object(r.useContext)(o),a=Object(i.a)(c,2),s=a[0],O=a[1],f=Object(r.useState)(!0),h=Object(i.a)(f,2),x=h[0],p=h[1],v=Object(r.useState)(!0),g=Object(i.a)(v,2),I=g[0],y=g[1],D=Object(r.useState)(!1),S=Object(i.a)(D,2),C=S[0],k=S[1],w=Object(r.useState)(""),F=Object(i.a)(w,2),U=F[0],W=F[1],E=Object(r.useState)(!0),N=Object(i.a)(E,2),T=N[0],B=N[1];Object(r.useEffect)((function(){var e=localStorage.getItem("userID");return e?(m.auth={userID:e},m.on("session",(function(e,t){y(!1),O(t)})),m.connect()):y(!1),function(){m.disconnect()}}),[]);var P=Object(J.jsxs)(u.a,{container:!0,style:n,className:e.paper,direction:"column",spacing:3,children:[Object(J.jsx)(u.a,{item:!0,children:Object(J.jsx)(l.a,{variant:"h5",gutterBottom:!0,style:{textAlign:"center"},children:"Welcome To Chatter"})}),Object(J.jsx)(u.a,{item:!0,children:Object(J.jsx)(j.a,{error:!C,id:"username",label:"Enter Username",variant:"outlined",helperText:"length greater than 2",fullWidth:!0,required:!0,onChange:function(e){W(e.target.value);var t=e.target.value.length>2;k(t),B(!t)}})}),Object(J.jsx)(u.a,{item:!0,children:Object(J.jsx)(d.a,{variant:"outlined",color:"primary",disabled:T,fullWidth:!0,onClick:function(){p(!1),m.auth={username:U},y(!0),m.on("session",(function(e,t){O(t),y(!1),localStorage.setItem("userID",e)})),m.connect()},children:"Okay"})})]});return I?Object(J.jsx)("div",{}):s?Object(J.jsx)(M,{}):Object(J.jsx)(b.a,{open:x,"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description",children:P})};var Q=function(){var e=Object(r.useState)(null),t=Object(i.a)(e,2),n=t[0],c=t[1];return Object(J.jsx)(o.Provider,{value:[n,c],children:Object(J.jsx)(G,{})})},V=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,207)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),r(e),c(e),a(e),s(e)}))};s.a.render(Object(J.jsx)(c.a.StrictMode,{children:Object(J.jsx)(Q,{})}),document.getElementById("root")),V()}},[[157,1,2]]]);
//# sourceMappingURL=main.0a1c47e6.chunk.js.map